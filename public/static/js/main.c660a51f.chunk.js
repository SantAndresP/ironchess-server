(this.webpackJsonpironchess=this.webpackJsonpironchess||[]).push([[0],{101:function(e,t,n){},108:function(e,t,n){},135:function(e,t){},138:function(e,t,n){},142:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),o=n.n(a),s=n(72),c=n.n(s),i=n(11),u=n(6),l=n(5),j=n(16),d=n.n(j),b=n(4),h="https://ironchess.herokuapp.com/api",m="https://ironchess.herokuapp.com/",O=n(78);n(101);var p=function(e){return Object(r.jsxs)(O.a,{className:"myNav",children:[Object(r.jsx)(i.b,{to:"/",children:"IronChess"}),e.loggedUser?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(i.b,{onClick:e.onLogout,children:"Log out"}),Object(r.jsx)(i.b,{to:"/private/".concat(e.loggedUser._id),children:e.loggedUser.username})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(i.b,{to:"/signin",children:"Sign in"}),Object(r.jsx)(i.b,{to:"/signup",children:"Sign up"})]})]})},g=n(149),f=n(147);n(108);var v=function(e){return Object(r.jsxs)("div",{className:"myHome",children:[Object(r.jsx)("h1",{className:"myTitle",children:"New game"}),Object(r.jsxs)("div",{className:"selectButtons",children:[Object(r.jsx)(i.b,{to:"/stockfish",children:Object(r.jsx)(f.a,{size:"lg",variant:"dark",children:Object(r.jsx)("img",{src:"https://i.imgur.com/jyTRjkY.png"})})}),Object(r.jsx)(i.b,{to:"/game/".concat(Object(g.a)(),"/").concat("w"),children:Object(r.jsx)(f.a,{size:"lg",variant:"light",children:Object(r.jsx)("img",{src:"https://i.imgur.com/PBtKjOl.png"})})})]})]})};var x=function(e){return Object(a.useEffect)((function(){return e.onUnmount}),[]),Object(r.jsxs)("form",{onSubmit:e.onSignin,children:[Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"Email address"}),Object(r.jsx)("input",{name:"email",type:"text"})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"Password"}),Object(r.jsx)("input",{name:"password",type:"password"})]}),Object(r.jsx)("button",{type:"submit",children:"Submit"}),e.errorMsg?Object(r.jsx)("p",{style:{color:"red"},children:e.errorMsg}):null]})};var w,S=function(e){return Object(r.jsxs)("form",{onSubmit:e.onSignup,children:[Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"Username"}),Object(r.jsx)("input",{name:"username",type:"text"})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"Email address"}),Object(r.jsx)("input",{name:"email",type:"text"})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"Password"}),Object(r.jsx)("input",{name:"password",type:"password"})]}),Object(r.jsx)("button",{type:"submit",children:"Submit"}),e.errorMessage?Object(r.jsx)("p",{style:{color:"red"},children:e.errorMessage}):null]})},y=n(47),k=n.n(y),q=n(74),C=n(21),N=n(30),U=n.n(N),M=(n(138),"".concat(m));var D=function(e){if(!e.loggedUser)return null;var t=e.match.params.id,n=e.loggedUser.username,o=Object(a.useState)(""),s=Object(l.a)(o,2),c=s[0],i=s[1],u=Object(a.useState)([]),j=Object(l.a)(u,2),d=j[0],b=j[1];Object(a.useEffect)((function(){(w=U()(M)).emit("join_room",t)}),[M]),Object(a.useEffect)((function(){w.on("receive_message",(function(e){b([].concat(Object(C.a)(d),[e]))}))}));var h=function(){var e=Object(q.a)(k.a.mark((function e(){var r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={room:t,content:{author:n,message:c}},e.next=3,w.emit("send_message",r);case 3:b([].concat(Object(C.a)(d),[r.content])),i("");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{className:"ChatBox",children:Object(r.jsxs)("div",{className:"chatContainer",children:[Object(r.jsx)("div",{className:"messages",children:d.map((function(e){return Object(r.jsx)("div",{className:"messageContainer",id:e.author==n?"You":"Other",children:Object(r.jsxs)("div",{className:"messageIndividual",children:[e.author,": ",e.message]})})}))}),Object(r.jsxs)("div",{className:"messageInputs",children:[Object(r.jsx)("input",{type:"text",placeholder:"Message...",onChange:function(e){i(e.target.value)}}),Object(r.jsx)("button",{onClick:h,children:"Send"})]})]})})},_=n(75),I=n(76),E=n(79),R=n(77),T=n(31),L=n.n(T),B=n(32),F=n.n(B),P=n(150);n(142);var G=function(e){return Object(r.jsxs)(P.a,{className:"myListGroup",children:["w"===e.turn?Object(r.jsx)(P.a.Item,{variant:"light",children:"White to move."}):Object(r.jsx)(P.a.Item,{variant:"dark",children:"Black to move."}),Object(r.jsx)(P.a.Item,{variant:"info",className:"myMovesList",children:e.moves})]})},H=(n(71),{borderRadius:"5px",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.5)"}),W=window.STOCKFISH,A=new L.a,z=function(e){Object(E.a)(n,e);var t=Object(R.a)(n);function n(){var e;Object(_.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={fen:"start",history:[],moves:"",turn:""},e.onDrop=function(t){var n=t.sourceSquare,r=t.targetSquare;if(null!==A.move({from:n,to:r,promotion:"q"}))return new Promise((function(t){e.setState({fen:A.fen()}),t()})).then((function(){return e.engineGame().prepareMove()}))},e.engineGame=function(t){t=t||{};var n,r="function"===typeof W?W():new Worker(t.stockfishjs||"stockfish.js"),a="function"===typeof W?W():new Worker(t.stockfishjs||"stockfish.js"),o={},s={wtime:3e3,btime:3e3,winc:1500,binc:1500},c=null;function i(e,t){(t||r).postMessage(e)}function u(){var e=("white"===s.clockColor?s.wtime:s.btime)+s.startTime-Date.now();c=setTimeout(u,e%1e3+1)}function l(){for(var e="",t=A.history({verbose:!0}),n=0;n<t.length;++n){var r=t[n];e+=" "+r.from+r.to+(r.promotion?r.promotion:"")}return e}setInterval((function(){n||A.game_over()&&(n=!0)}),500),i("uci");var j=function(){!function(){if(null!==c&&(clearTimeout(c),c=null),s.startTime>0){var e=Date.now()-s.startTime;s.startTime=null,"white"===s.clockColor?s.wtime=Math.max(0,s.wtime-e):s.btime=Math.max(0,s.btime-e)}}();var e="w"===A.turn()?"white":"black";A.game_over()||("black"!==e&&(i("position startpos moves"+l()),i("position startpos moves"+l(),a),i("eval",a),s&&s.wtime?i("go "+(s.depth?"depth "+s.depth:"")+" wtime "+s.wtime+" winc "+s.winc+" btime "+s.btime+" binc "+s.binc):i("go "+(s.depth?"depth "+s.depth:""))),A.history().length>=2&&!s.depth&&!s.nodes&&("w"===A.turn()?(s.wtime+=s.winc,s.clockColor="white"):(s.btime+=s.binc,s.clockColor="black"),s.startTime=Date.now(),u()))};return a.onmessage=function(e){var t;"uciok"!==(t=e&&"object"===typeof e?e.data:e)&&"readyok"!==t&&t.substr(0,11)},r.onmessage=function(t){var n;if("uciok"===(n=t&&"object"===typeof t?t.data:t))o.engineLoaded=!0;else if("readyok"===n)o.engineReady=!0;else{var r=n.match(/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/);if(r?(A.move({from:r[1],to:r[2],promotion:r[3]}),e.setState({fen:A.fen()}),j(),i("eval",a)):(r=n.match(/^info .*\bdepth (\d+) .*\bnps (\d+)/))&&(o.search="Depth: "+r[1]+" Nps: "+r[2]),r=n.match(/^info .*\bscore (\w+) (-?\d+)/)){var s=parseInt(r[2],10)*("w"===A.turn()?1:-1);"cp"===r[1]?o.score=(s/100).toFixed(2):"mate"===r[1]&&(o.score="Mate in "+Math.abs(s)),(r=n.match(/\b(upper|lower)bound\b/))&&(o.score=("upper"===r[1]===("w"===A.turn())?"<= ":">= ")+o.score)}}},{start:function(){i("ucinewgame"),i("isready"),o.engineReady=!1,o.search=null,j(),n=!1},prepareMove:function(){j()}}},e}return Object(I.a)(n,[{key:"componentDidMount",value:function(){this.setState({fen:A.fen()}),this.engineGame().prepareMove()}},{key:"componentDidUpdate",value:function(){this.moves=A.pgn(),"w"===A.turn()?this.turn="White to move.":this.turn="Black to move.",console.log(this.moves),console.log(this.turn)}},{key:"render",value:function(){var e=this.state.fen;return this.props.children({position:e,onDrop:this.onDrop,moves:this.moves,turn:this.turn})}}]),n}(a.Component);var J,K,Y,V,Q=function(){return Object(r.jsx)("div",{className:"myGamespace",children:Object(r.jsx)(z,{children:function(e){var t=e.position,n=e.onDrop,a=e.moves,o=e.turn;return Object(r.jsxs)("div",{className:"myChessboard",children:[Object(r.jsx)(F.a,{id:"stockfish",position:t,width:550,onDrop:n,boardStyle:H,orientation:"black"}),Object(r.jsx)(G,{moves:a,turn:o})]})}})})},X=n(15),Z=n(148),$="".concat(m);function ee(e){var t=Object(a.useState)("start"),n=Object(l.a)(t,2),o=n[0],s=n[1],c=Object(a.useState)({}),i=Object(l.a)(c,2),j=i[0],d=i[1],b=Object(a.useState)({}),h=Object(l.a)(b,2),m=h[0],O=h[1],p=Object(a.useState)(""),g=Object(l.a)(p,2),f=g[0],v=(g[1],Object(a.useState)([])),x=Object(l.a)(v,2),w=x[0],S=x[1],y=Object(a.useState)(""),k=Object(l.a)(y,2),q=k[0],N=k[1],M=Object(a.useState)("w"),D=Object(l.a)(M,2),_=D[0],I=D[1],E=Object(a.useState)(""),R=Object(l.a)(E,2),T=R[0],B=R[1],F=Object(a.useState)(""),P=Object(l.a)(F,2),G=P[0],H=P[1],W=Object(a.useState)(""),A=Object(l.a)(W,2),z=A[0],Q=A[1],ee=Object(a.useState)([]),ne=Object(l.a)(ee,2),re=ne[0];ne[1];Object(a.useEffect)((function(){Y=L()(),K=U()($),J=e.match.params.id,"w"===(V=e.match.params.color)&&0===G.length?(B("white"),H(e.loggedUser_id),K.emit("join_game",{roomId:J,white:e.loggedUser._id})):"b"===V&&0===z.length?(B("black"),Q(e.loggedUser_id),K.emit("join_game",{roomId:J,black:e.loggedUser._id})):re.push(e.loggedUser._id)}),[]),Object(a.useEffect)((function(){K.on("receive_info",(function(e){console.log("Information received.",e),s(e.position),N(e.moves),I(e.turn),Y.load_pgn(e.moves)}))}));return e.loggedUser?e.children({position:o,handleMouseOverSquare:function(e){var t=Y.moves({square:e,verbose:!0});if(0!==t.length){for(var n=[],r=0;r<t.length;r++)n.push(t[r].to);!function(e,t){var n=[e].concat(Object(C.a)(t)).reduce((function(e,t){return Object(u.a)(Object(u.a)(Object(u.a)({},e),Object(X.a)({},t,{background:"radial-gradient(circle, #fffc00 36%, transparent 40%)",borderRadius:"50%"})),te({history:w,pieceSquare:f}))}),{});O(Object(u.a)(Object(u.a)({},m),n))}(e,n)}},handleMouseOutSquare:function(e){O(te({pieceSquare:f,history:w}))},handleDrop:function(e){var t=e.sourceSquare,n=e.targetSquare;V===Y.turn()&&(null!==Y.move({from:t,to:n,promotion:"q"})&&(s(Y.fen()),S(Y.history({verbose:!0})),N(Y.pgn()),I(Y.turn()),O(te({pieceSquare:f,history:w})),K.emit("send_game_info",{room:J,moves:Y.pgn(),position:Y.fen(),turn:Y.turn()})))},handleSquareRightClick:function(e){return O(Object(X.a)({},e,{backgroundColor:"deepPink"}))},handleDragOverSquare:function(e){d("e4"===e||"d4"===e||"e5"===e||"d5"===e?{backgroundColor:"cornFlowerBlue"}:{boxShadow:"inset 0 0 1px 4px rgb(255, 255, 0)"})},dropSquareStyle:j,squareStyles:m,moves:q,turn:_,orientation:T}):Object(r.jsx)(Z.a,{animation:"border",role:"status",variant:"light",children:Object(r.jsx)("span",{className:"sr-only",children:"Loading..."})})}var te=function(e){var t=e.pieceSquare,n=e.history,r=n.length&&n[n.length-1].from,a=n.length&&n[n.length-1].to;return Object(u.a)(Object(u.a)(Object(X.a)({},t,{backgroundColor:"rgba(255, 255, 0, 0.4)"}),n.length&&Object(X.a)({},r,{backgroundColor:"rgba(255, 255, 0, 0.4)"})),n.length&&Object(X.a)({},a,{backgroundColor:"rgba(255, 255, 0, 0.4)"}))},ne=function(e){return Object(r.jsx)(ee,Object(u.a)(Object(u.a)({},e),{},{children:function(e){var t=e.position,n=e.handleDrop,a=e.handleMouseOverSquare,o=e.handleMouseOutSquare,s=e.handleDragOverSquare,c=e.handleSquareRightClick,i=e.squareStyles,u=e.dropSquareStyle,l=e.moves,j=e.turn,d=e.orientation;return Object(r.jsxs)("div",{className:"myChessboard",children:[Object(r.jsx)(F.a,{id:"HumanVsHuman",width:550,orientation:d,position:t,onDrop:n,onMouseOverSquare:a,onMouseOutSquare:o,onSquareRightClick:c,onDragOverSquare:s,squareStyles:i,dropSquareStyle:u,boardStyle:{borderRadius:"5px",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.5)"}}),Object(r.jsxs)("div",{className:"movesAndButton",children:[Object(r.jsx)(G,{moves:l,turn:j}),Object(r.jsx)(f.a,{children:"Resign"})]})]})}}))};var re=function(e){return e.loggedUser?"/stockfish"===e.match.path?Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(Q,{})}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(D,Object(u.a)({loggedUser:e.loggedUser},e)),Object(r.jsx)(ne,Object(u.a)({loggedUser:e.loggedUser},e))]}):null};var ae=function(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){d.a.get("".concat(h,"/games"),{withCredentials:!0}).then((function(e){o(e.data),console.log(n)}))}),[]),n.length?Object(r.jsx)("div",{className:"myGamesList",children:n.map((function(e){return Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:e.roomId}),Object(r.jsx)("p",{children:e.white}),Object(r.jsx)("p",{children:e.movetext})]})}))}):Object(r.jsx)(Z.a,{animation:"border",role:"status",variant:"light",children:Object(r.jsx)("span",{className:"sr-only",children:"Loading..."})})};var oe=Object(b.f)((function(e){var t=Object(a.useState)(null),n=Object(l.a)(t,2),o=n[0],s=n[1],c=Object(a.useState)(null),i=Object(l.a)(c,2),j=i[0],m=i[1];Object(a.useEffect)((function(){o||d.a.get("".concat(h,"/user"),{withCredentials:!0}).then((function(e){s(e.data)}))}),[]);var O=function(t){t.preventDefault();var n=t.target,r=n.username,a=n.email,o=n.password;d.a.post("".concat(h,"/signup"),{username:r.value,email:a.value,password:o.value},{withCredentials:!0}).then((function(t){s(t.data),e.history.push("/")})).catch((function(e){m(e.response.data.error)}))},g=function(t){t.preventDefault();var n=t.target,r=n.email,a=n.password;d.a.post("".concat(h,"/signin"),{email:r.value,password:a.value},{withCredentials:!0}).then((function(t){s(t.data),e.history.push("/")})).catch((function(e){m(e.response.data.error)}))},f=function(){m(null)};return Object(r.jsxs)("div",{className:"myApp",children:[Object(r.jsx)("header",{children:Object(r.jsx)(p,{loggedUser:o,onLogout:function(t){d.a.post("".concat(h,"/logout"),{},{withCredentials:!0}).then((function(){s(null),e.history.push("/")}))}})}),Object(r.jsx)("main",{children:Object(r.jsxs)(b.c,{children:[Object(r.jsx)(b.a,{exact:!0,path:"/",render:function(){return Object(r.jsx)(v,{loggedUser:o})}}),Object(r.jsx)(b.a,{path:"/signin",render:function(e){return Object(r.jsx)(x,Object(u.a)({onUnmount:f,errorMsg:j,onSignin:g},e))}}),Object(r.jsx)(b.a,{path:"/signup",render:function(e){return Object(r.jsx)(S,Object(u.a)({onSignup:O},e))}}),Object(r.jsx)(b.a,{path:"/private/:id",render:function(){return Object(r.jsx)(ae,{loggedUser:o})}}),Object(r.jsx)(b.a,{path:"/public/:id",render:function(){return Object(r.jsx)(PublicProfile,{loggedUser:o})}}),Object(r.jsx)(b.a,{path:"/stockfish",render:function(e){return Object(r.jsx)(re,Object(u.a)({loggedUser:o},e))}}),Object(r.jsx)(b.a,{exact:!0,path:"/game/:id/:color",render:function(e){return Object(r.jsx)(re,Object(u.a)({loggedUser:o},e))}})]})})]})}));n(143),n(144);c.a.render(Object(r.jsx)(i.a,{children:Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(oe,{})})}),document.getElementById("root"))},71:function(e,t,n){}},[[145,1,2]]]);
//# sourceMappingURL=main.c660a51f.chunk.js.map