(this.webpackJsonpironchess=this.webpackJsonpironchess||[]).push([[0],{111:function(e,t,n){},117:function(e,t,n){},118:function(e,t,n){},145:function(e,t){},148:function(e,t,n){},152:function(e,t,n){},153:function(e,t,n){},154:function(e,t,n){},155:function(e,t,n){},157:function(e,t,n){},158:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n.n(a),o=n(26),s=n.n(o),i=n(15),l=n(10),u=n(8),j=n(20),d=n.n(j),b=n(6),h="http://localhost:5000/api",m="http://localhost:5000/",O=n(88);n(111);var p=function(e){return Object(r.jsxs)(O.a,{className:"myNav",children:[Object(r.jsx)(i.b,{to:"/",children:Object(r.jsx)("img",{src:"https://i.imgur.com/cy6a0Hk.png",style:{width:"200px"}})}),Object(r.jsx)("div",{className:"userButtons",children:e.loggedUser?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(i.b,{onClick:e.onLogout,children:"LOG OUT"}),Object(r.jsx)(i.b,{to:"/private/".concat(e.loggedUser._id),children:e.loggedUser.username.toUpperCase()})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(i.b,{to:"/signin",children:"SIGN IN"}),Object(r.jsx)(i.b,{to:"/signup",children:"SIGN UP"})]})})]})},f=n(166),g=n(161);n(117);var v=function(e){return Object(r.jsx)("div",{className:"myHome",children:Object(r.jsxs)("div",{className:"selectButtons",children:[Object(r.jsx)(i.b,{to:"/stockfish",children:Object(r.jsx)(g.a,{size:"lg",variant:"danger",className:"vsButton",children:Object(r.jsx)("img",{src:"https://i.imgur.com/Vg9707Z.png"})})}),Object(r.jsx)(i.b,{to:"/game/".concat(Object(f.a)(),"/").concat("w"),children:Object(r.jsx)(g.a,{size:"lg",variant:"primary",className:"vsButton",children:Object(r.jsx)("img",{src:"https://i.imgur.com/Z8tiVGJ.png"})})})]})})},x=n(165);n(118);var w=function(e){return Object(a.useEffect)((function(){return e.onUnmount}),[]),Object(r.jsx)("div",{className:"myFormContainer",children:Object(r.jsxs)(x.a,{onSubmit:e.onSignin,className:"myForm",children:[Object(r.jsxs)(x.a.Group,{controlId:"formBasicEmail",children:[Object(r.jsx)(x.a.Label,{children:"Email address"}),Object(r.jsx)(x.a.Control,{name:"email",type:"text",placeholder:"Enter email"})]}),Object(r.jsxs)(x.a.Group,{controlId:"formBasicPassword",children:[Object(r.jsx)(x.a.Label,{children:"Password"}),Object(r.jsx)(x.a.Control,{name:"password",type:"password",placeholder:"Password"})]}),Object(r.jsx)(g.a,{variant:"primary",type:"submit",children:"Submit"}),e.errorMsg?Object(r.jsx)(Alert,{variant:"danger",children:e.errorMsg}):null]})})},y=n(164);var S,k=function(e){return Object(r.jsx)("div",{className:"myFormContainer",children:Object(r.jsxs)(x.a,{onSubmit:e.onSignup,className:"myForm",children:[Object(r.jsxs)(x.a.Group,{controlId:"formBasicEmail",children:[Object(r.jsx)(x.a.Label,{children:"Email address"}),Object(r.jsx)(x.a.Control,{name:"email",type:"text",placeholder:"Enter email"})]}),Object(r.jsxs)(x.a.Group,{controlId:"formBasicEmail",children:[Object(r.jsx)(x.a.Label,{children:"Username"}),Object(r.jsx)(x.a.Control,{name:"username",type:"text",placeholder:"Enter username"})]}),Object(r.jsxs)(x.a.Group,{controlId:"formBasicPassword",children:[Object(r.jsx)(x.a.Label,{children:"Password"}),Object(r.jsx)(x.a.Control,{name:"password",type:"password",placeholder:"Password"})]}),Object(r.jsx)(g.a,{variant:"primary",type:"submit",children:"Submit"}),e.errorMsg?Object(r.jsx)(y.a,{variant:"danger",children:e.errorMsg}):null]})})},C=n(17),N=n(56),q=n.n(N),U=n(84),I=n(29),M=n(41),D=n.n(M),G=(n(148),n(167)),E=n(168),_=n(162),B=n(81),L="".concat(m);var P=function(e){var t;if(!e.loggedUser)return null;var n=e.match.params.id,c=e.loggedUser.username,o=Object(a.useState)(""),s=Object(u.a)(o,2),i=s[0],l=s[1],j=Object(a.useState)([]),d=Object(u.a)(j,2),b=d[0],h=d[1];Object(a.useEffect)((function(){(S=D()(L)).emit("join_room",n)}),[L]),Object(a.useEffect)((function(){S.on("receive_message",(function(e){h([].concat(Object(I.a)(b),[e]))}))}));var m=function(){var e=Object(U.a)(q.a.mark((function e(){var t;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={room:n,content:{author:c,message:i}},e.next=3,S.emit("send_message",t);case 3:h([].concat(Object(I.a)(b),[t.content])),l("");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(G.a,{className:"myChatBoxCard",children:[Object(r.jsx)(E.a,{children:b.map((function(e){return Object(r.jsxs)(E.a.Item,{variant:e.author==c?"primary":"success",children:[Object(r.jsxs)("b",{children:[e.author,":"]})," ",e.message]})}))}),Object(r.jsxs)(_.a,(t={className:"mb-3"},Object(C.a)(t,"className","myChatInput"),Object(C.a)(t,"children",[Object(r.jsx)(B.a,{type:"text",onChange:function(e){l(e.target.value)},placeholder:"WRITE..."}),Object(r.jsx)(_.a.Append,{children:Object(r.jsx)(g.a,{onClick:m,variant:"primary",children:"Send"})})]),t))]})},T=n(85),F=n(86),R=n(89),A=n(87),W=n(42),H=n.n(W),J=n(43),V=n.n(J);n(152);var z=function(e){return Object(r.jsxs)(E.a,{className:"myListGroup",children:["w"===e.turn?Object(r.jsx)(E.a.Item,{variant:"light",children:"White to move."}):Object(r.jsx)(E.a.Item,{variant:"dark",children:"Black to move."}),Object(r.jsx)(E.a.Item,{variant:"info",className:"myMovesList",children:e.moves})]})},Z=(n(79),{borderRadius:"5px",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.5)"}),K=window.STOCKFISH,Q=new H.a,X=function(e){Object(R.a)(n,e);var t=Object(A.a)(n);function n(){var e;Object(T.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={fen:"start",history:[],moves:"",turn:""},e.onDrop=function(t){var n=t.sourceSquare,r=t.targetSquare;if(null!==Q.move({from:n,to:r,promotion:"q"}))return new Promise((function(t){e.setState({fen:Q.fen()}),t()})).then((function(){return e.engineGame().prepareMove()}))},e.engineGame=function(t){t=t||{};var n,r="function"===typeof K?K():new Worker(t.stockfishjs||"stockfish.js"),a="function"===typeof K?K():new Worker(t.stockfishjs||"stockfish.js"),c={},o={wtime:3e3,btime:3e3,winc:1500,binc:1500},s=null;function i(e,t){(t||r).postMessage(e)}function l(){var e=("white"===o.clockColor?o.wtime:o.btime)+o.startTime-Date.now();s=setTimeout(l,e%1e3+1)}function u(){for(var e="",t=Q.history({verbose:!0}),n=0;n<t.length;++n){var r=t[n];e+=" "+r.from+r.to+(r.promotion?r.promotion:"")}return e}setInterval((function(){n||Q.game_over()&&(n=!0)}),500),i("uci");var j=function(){!function(){if(null!==s&&(clearTimeout(s),s=null),o.startTime>0){var e=Date.now()-o.startTime;o.startTime=null,"white"===o.clockColor?o.wtime=Math.max(0,o.wtime-e):o.btime=Math.max(0,o.btime-e)}}();var e="w"===Q.turn()?"white":"black";Q.game_over()||("black"!==e&&(i("position startpos moves"+u()),i("position startpos moves"+u(),a),i("eval",a),o&&o.wtime?i("go "+(o.depth?"depth "+o.depth:"")+" wtime "+o.wtime+" winc "+o.winc+" btime "+o.btime+" binc "+o.binc):i("go "+(o.depth?"depth "+o.depth:""))),Q.history().length>=2&&!o.depth&&!o.nodes&&("w"===Q.turn()?(o.wtime+=o.winc,o.clockColor="white"):(o.btime+=o.binc,o.clockColor="black"),o.startTime=Date.now(),l()))};return a.onmessage=function(e){var t;"uciok"!==(t=e&&"object"===typeof e?e.data:e)&&"readyok"!==t&&t.substr(0,11)},r.onmessage=function(t){var n;if("uciok"===(n=t&&"object"===typeof t?t.data:t))c.engineLoaded=!0;else if("readyok"===n)c.engineReady=!0;else{var r=n.match(/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/);if(r?(Q.move({from:r[1],to:r[2],promotion:r[3]}),e.setState({fen:Q.fen()}),j(),i("eval",a)):(r=n.match(/^info .*\bdepth (\d+) .*\bnps (\d+)/))&&(c.search="Depth: "+r[1]+" Nps: "+r[2]),r=n.match(/^info .*\bscore (\w+) (-?\d+)/)){var o=parseInt(r[2],10)*("w"===Q.turn()?1:-1);"cp"===r[1]?c.score=(o/100).toFixed(2):"mate"===r[1]&&(c.score="Mate in "+Math.abs(o)),(r=n.match(/\b(upper|lower)bound\b/))&&(c.score=("upper"===r[1]===("w"===Q.turn())?"<= ":">= ")+c.score)}}},{start:function(){i("ucinewgame"),i("isready"),c.engineReady=!1,c.search=null,j(),n=!1},prepareMove:function(){j()}}},e}return Object(F.a)(n,[{key:"componentDidMount",value:function(){this.setState({fen:Q.fen()}),this.engineGame().prepareMove()}},{key:"componentDidUpdate",value:function(){this.moves=Q.pgn(),"w"===Q.turn()?this.turn="White to move.":this.turn="Black to move.",console.log(this.moves),console.log(this.turn)}},{key:"render",value:function(){var e=this.state.fen;return this.props.children({position:e,onDrop:this.onDrop,moves:this.moves,turn:this.turn})}}]),n}(a.Component);var Y,$,ee,te,ne=function(){return Object(r.jsx)("div",{className:"myGamespace",children:Object(r.jsx)(X,{children:function(e){var t=e.position,n=e.onDrop,a=e.moves,c=e.turn;return Object(r.jsxs)("div",{className:"myChessboard",children:[Object(r.jsx)(V.a,{id:"stockfish",position:t,width:550,onDrop:n,boardStyle:Z,orientation:"black"}),Object(r.jsx)(z,{moves:a,turn:c})]})}})})},re=n(163),ae="".concat(m);function ce(e){var t=Object(a.useState)("start"),n=Object(u.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)({}),i=Object(u.a)(s,2),j=i[0],d=i[1],b=Object(a.useState)({}),h=Object(u.a)(b,2),m=h[0],O=h[1],p=Object(a.useState)(""),f=Object(u.a)(p,2),g=f[0],v=(f[1],Object(a.useState)([])),x=Object(u.a)(v,2),w=x[0],y=x[1],S=Object(a.useState)(""),k=Object(u.a)(S,2),N=k[0],q=k[1],U=Object(a.useState)("w"),M=Object(u.a)(U,2),G=M[0],E=M[1],_=Object(a.useState)(""),B=Object(u.a)(_,2),L=B[0],P=B[1],T=Object(a.useState)(""),F=Object(u.a)(T,2),R=F[0],A=F[1],W=Object(a.useState)(""),J=Object(u.a)(W,2),V=J[0],z=J[1],Z=Object(a.useState)([]),K=Object(u.a)(Z,2),Q=K[0];K[1];Object(a.useEffect)((function(){ee=H()(),$=D()(ae),Y=e.match.params.id,"w"===(te=e.match.params.color)&&0===R.length?(P("white"),A(e.loggedUser_id),$.emit("join_game",{roomId:Y,white:e.loggedUser._id})):"b"===te&&0===V.length?(P("black"),z(e.loggedUser_id),$.emit("join_game",{roomId:Y,black:e.loggedUser._id})):Q.push(e.loggedUser._id)}),[]),Object(a.useEffect)((function(){$.on("receive_info",(function(e){console.log("Information received.",e),o(e.position),q(e.moves),E(e.turn),ee.load_pgn(e.moves)}))}));return e.loggedUser?e.children({position:c,handleMouseOverSquare:function(e){var t=ee.moves({square:e,verbose:!0});if(0!==t.length){for(var n=[],r=0;r<t.length;r++)n.push(t[r].to);!function(e,t){var n=[e].concat(Object(I.a)(t)).reduce((function(e,t){return Object(l.a)(Object(l.a)(Object(l.a)({},e),Object(C.a)({},t,{background:"radial-gradient(circle, #fffc00 36%, transparent 40%)",borderRadius:"50%"})),oe({history:w,pieceSquare:g}))}),{});O(Object(l.a)(Object(l.a)({},m),n))}(e,n)}},handleMouseOutSquare:function(e){O(oe({pieceSquare:g,history:w}))},handleDrop:function(e){var t=e.sourceSquare,n=e.targetSquare;te===ee.turn()&&(null!==ee.move({from:t,to:n,promotion:"q"})&&(o(ee.fen()),y(ee.history({verbose:!0})),q(ee.pgn()),E(ee.turn()),O(oe({pieceSquare:g,history:w})),$.emit("send_game_info",{room:Y,moves:ee.pgn(),position:ee.fen(),turn:ee.turn()})))},handleSquareRightClick:function(e){return O(Object(C.a)({},e,{backgroundColor:"deepPink"}))},handleDragOverSquare:function(e){d("e4"===e||"d4"===e||"e5"===e||"d5"===e?{backgroundColor:"cornFlowerBlue"}:{boxShadow:"inset 0 0 1px 4px rgb(255, 255, 0)"})},dropSquareStyle:j,squareStyles:m,moves:N,turn:G,orientation:L}):Object(r.jsx)(re.a,{animation:"border",role:"status",variant:"light",children:Object(r.jsx)("span",{className:"sr-only",children:"Loading..."})})}var oe=function(e){var t=e.pieceSquare,n=e.history,r=n.length&&n[n.length-1].from,a=n.length&&n[n.length-1].to;return Object(l.a)(Object(l.a)(Object(C.a)({},t,{backgroundColor:"rgba(255, 255, 0, 0.4)"}),n.length&&Object(C.a)({},r,{backgroundColor:"rgba(255, 255, 0, 0.4)"})),n.length&&Object(C.a)({},a,{backgroundColor:"rgba(255, 255, 0, 0.4)"}))},se=function(e){return Object(r.jsx)(ce,Object(l.a)(Object(l.a)({},e),{},{children:function(e){var t=e.position,n=e.handleDrop,a=e.handleMouseOverSquare,c=e.handleMouseOutSquare,o=e.handleDragOverSquare,s=e.handleSquareRightClick,i=e.squareStyles,l=e.dropSquareStyle,u=e.moves,j=e.turn,d=e.orientation;return Object(r.jsxs)("div",{className:"myChessboard",children:[Object(r.jsx)(V.a,{id:"HumanVsHuman",width:550,orientation:d,position:t,onDrop:n,onMouseOverSquare:a,onMouseOutSquare:c,onSquareRightClick:s,onDragOverSquare:o,squareStyles:i,dropSquareStyle:l,boardStyle:{borderRadius:"5px",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.5)"}}),Object(r.jsx)("div",{className:"movesAndButton",children:Object(r.jsx)(z,{moves:u,turn:j})})]})}}))};n(153);var ie=function(e){return e.loggedUser?"/stockfish"===e.match.path?Object(r.jsx)("div",{children:Object(r.jsx)(ne,{})}):Object(r.jsxs)("div",{className:"myGame",children:[Object(r.jsx)(P,Object(l.a)({loggedUser:e.loggedUser},e)),Object(r.jsx)(se,Object(l.a)({loggedUser:e.loggedUser},e))]}):null};n(154);var le=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){d.a.get("".concat(h,"/games"),{withCredentials:!0}).then((function(e){c(e.data),console.log(e.data)}))}),[]),n.length?Object(r.jsx)("div",{className:"myGamesList",children:n.map((function(e){return Object(r.jsx)("div",{className:"myGameInfoContainer",children:Object(r.jsx)(E.a,{children:Object(r.jsx)(E.a.Item,{children:Object(r.jsxs)("div",{className:"myGameInfo",children:[Object(r.jsxs)("p",{children:[Object(r.jsx)("b",{children:"Id:"})," ",e.roomId]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("b",{children:"White:"})," ",e.white]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("b",{children:"Black:"})," ",e.black?e.black:"N/A"]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("b",{children:"Moves:"})," ",e.movetext]})]})})})})}))}):Object(r.jsx)(re.a,{animation:"border",role:"status",variant:"light",children:Object(r.jsx)("span",{className:"sr-only",children:"Loading..."})})};n(155);var ue=Object(b.f)((function(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)(null),i=Object(u.a)(s,2),j=i[0],m=i[1];Object(a.useEffect)((function(){c||d.a.get("".concat(h,"/user"),{withCredentials:!0}).then((function(e){o(e.data)}))}),[]);var O=function(t){t.preventDefault();var n=t.target,r=n.username,a=n.email,c=n.password;d.a.post("".concat(h,"/signup"),{username:r.value,email:a.value,password:c.value},{withCredentials:!0}).then((function(t){o(t.data),e.history.push("/")})).catch((function(e){m(e.response.data.error)}))},f=function(t){t.preventDefault();var n=t.target,r=n.email,a=n.password;d.a.post("".concat(h,"/signin"),{email:r.value,password:a.value},{withCredentials:!0}).then((function(t){o(t.data),e.history.push("/")})).catch((function(e){m(e.response.data.error)}))},g=function(){m(null)};return Object(r.jsxs)("div",{className:"myApp",children:[Object(r.jsx)("header",{children:Object(r.jsx)(p,{loggedUser:c,onLogout:function(t){d.a.post("".concat(h,"/logout"),{},{withCredentials:!0}).then((function(){o(null),e.history.push("/")}))}})}),Object(r.jsx)("main",{children:Object(r.jsxs)(b.c,{children:[Object(r.jsx)(b.a,{exact:!0,path:"/",render:function(){return Object(r.jsx)(v,{loggedUser:c})}}),Object(r.jsx)(b.a,{path:"/signin",render:function(e){return Object(r.jsx)(w,Object(l.a)({onUnmount:g,errorMsg:j,onSignin:f},e))}}),Object(r.jsx)(b.a,{path:"/signup",render:function(e){return Object(r.jsx)(k,Object(l.a)({onSignup:O},e))}}),Object(r.jsx)(b.a,{path:"/private/:id",render:function(){return Object(r.jsx)(le,{loggedUser:c})}}),Object(r.jsx)(b.a,{path:"/public/:id",render:function(){return Object(r.jsx)(PublicProfile,{loggedUser:c})}}),Object(r.jsx)(b.a,{path:"/stockfish",render:function(e){return Object(r.jsx)(ie,Object(l.a)({loggedUser:c},e))}}),Object(r.jsx)(b.a,{exact:!0,path:"/game/:id/:color",render:function(e){return Object(r.jsx)(ie,Object(l.a)({loggedUser:c},e))}})]})})]})}));n(156),n(157);s.a.render(Object(r.jsx)(i.a,{children:Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(ue,{})})}),document.getElementById("root"))},79:function(e,t,n){}},[[158,1,2]]]);
//# sourceMappingURL=main.97154a6a.chunk.js.map