(this.webpackJsonpironchess=this.webpackJsonpironchess||[]).push([[0],{108:function(e,t,n){},114:function(e,t,n){},141:function(e,t){},144:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){},153:function(e,t,n){},154:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),c=n.n(r),s=n(26),o=n.n(s),i=n(12),l=n(8),j=n(6),u=n(19),d=n.n(u),b=n(7),h="https://ironchess.herokuapp.com/api",m="https://ironchess.herokuapp.com/",O=n(86);n(108);var p=function(e){return Object(a.jsxs)(O.a,{className:"myNav",children:[Object(a.jsx)(i.b,{to:"/",children:Object(a.jsx)("img",{src:"https://i.imgur.com/cy6a0Hk.png",style:{width:"200px"}})}),Object(a.jsx)("div",{className:"userButtons",children:e.loggedUser?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(i.b,{onClick:e.onLogout,children:"LOG OUT"}),Object(a.jsx)(i.b,{to:"/private/".concat(e.loggedUser._id),children:e.loggedUser.username.toUpperCase()})]}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(i.b,{to:"/signin",children:"SIGN IN"}),Object(a.jsx)(i.b,{to:"/signup",children:"SIGN UP"})]})})]})},g=n(162),f=n(157);n(114);var x=function(e){return Object(a.jsx)("div",{className:"myHome",children:Object(a.jsxs)("div",{className:"selectButtons",children:[Object(a.jsx)(i.b,{to:"/stockfish",children:Object(a.jsx)(f.a,{size:"lg",variant:"danger",className:"vsButton",children:Object(a.jsx)("img",{src:"https://i.imgur.com/Vg9707Z.png"})})}),Object(a.jsx)(i.b,{to:"/game/".concat(Object(g.a)(),"/").concat("w"),children:Object(a.jsx)(f.a,{size:"lg",variant:"primary",className:"vsButton",children:Object(a.jsx)("img",{src:"https://i.imgur.com/Z8tiVGJ.png"})})})]})})},v=n(161);n(67);var y=function(e){return Object(r.useEffect)((function(){return e.onUnmount}),[]),Object(a.jsx)("div",{className:"myFormContainer",children:Object(a.jsxs)(v.a,{onSubmit:e.onSignin,className:"myForm",children:[Object(a.jsxs)(v.a.Group,{controlId:"formBasicEmail",children:[Object(a.jsx)(v.a.Label,{children:"Email address"}),Object(a.jsx)(v.a.Control,{name:"email",type:"text",placeholder:"Enter email"})]}),Object(a.jsxs)(v.a.Group,{controlId:"formBasicPassword",children:[Object(a.jsx)(v.a.Label,{children:"Password"}),Object(a.jsx)(v.a.Control,{name:"password",type:"password",placeholder:"Password"})]}),Object(a.jsx)(f.a,{variant:"primary",type:"submit",children:"Submit"}),e.errorMsg?Object(a.jsx)(Alert,{variant:"danger",children:e.errorMsg}):null]})})},S=n(160);var w,k=function(e){return Object(a.jsx)("div",{className:"myFormContainer",children:Object(a.jsxs)(v.a,{onSubmit:e.onSignup,className:"myForm",children:[Object(a.jsxs)(v.a.Group,{controlId:"formBasicEmail",children:[Object(a.jsx)(v.a.Label,{children:"Email address"}),Object(a.jsx)(v.a.Control,{name:"email",type:"text",placeholder:"Enter email"})]}),Object(a.jsxs)(v.a.Group,{controlId:"formBasicEmail",children:[Object(a.jsx)(v.a.Label,{children:"Username"}),Object(a.jsx)(v.a.Control,{name:"username",type:"text",placeholder:"Enter username"})]}),Object(a.jsxs)(v.a.Group,{controlId:"formBasicPassword",children:[Object(a.jsx)(v.a.Label,{children:"Password"}),Object(a.jsx)(v.a.Control,{name:"password",type:"password",placeholder:"Password"})]}),Object(a.jsx)(f.a,{variant:"primary",type:"submit",children:"Submit"}),e.errorMsg?Object(a.jsx)(S.a,{variant:"danger",children:e.errorMsg}):null]})})},C=n(17),N=n(56),U=n.n(N),q=n(85),I=n(29),M=n(41),E=n.n(M),B=(n(144),n(158)),L=n(163),_=n(164),D=n(159),G=n(82),F="".concat(m);var T=function(e){var t;if(!e.loggedUser)return Object(a.jsx)(B.a,{animation:"border",role:"status",variant:"light",children:Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})});var n=e.match.params.id,c=e.loggedUser.username,s=Object(r.useState)(""),o=Object(j.a)(s,2),i=o[0],l=o[1],u=Object(r.useState)([]),d=Object(j.a)(u,2),b=d[0],h=d[1];Object(r.useEffect)((function(){(w=E()(F)).emit("join_room",n)}),[F]),Object(r.useEffect)((function(){w.on("receive_message",(function(e){h([].concat(Object(I.a)(b),[e]))}))}));var m=function(){var e=Object(q.a)(U.a.mark((function e(){var t;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={room:n,content:{author:c,message:i}},e.next=3,w.emit("send_message",t);case 3:h([].concat(Object(I.a)(b),[t.content])),l("");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(L.a,{className:"myChatBoxCard",children:[Object(a.jsx)(_.a,{children:b.map((function(e){return Object(a.jsxs)(_.a.Item,{variant:e.author==c?"primary":"success",children:[Object(a.jsxs)("b",{children:[e.author,":"]})," ",e.message]})}))}),Object(a.jsxs)(D.a,(t={className:"mb-3"},Object(C.a)(t,"className","myChatInput"),Object(C.a)(t,"children",[Object(a.jsx)(G.a,{type:"text",onChange:function(e){l(e.target.value)},placeholder:"WRITE..."}),Object(a.jsx)(D.a.Append,{children:Object(a.jsx)(f.a,{onClick:m,variant:"primary",children:"Send"})})]),t))]})},P=n(42),R=n.n(P),A=n(43),H=n.n(A);n(148);var W,J=function(e){return Object(a.jsxs)(_.a,{className:"myListGroup",children:["w"===e.turn?Object(a.jsx)(_.a.Item,{variant:"light",children:"White to move."}):Object(a.jsx)(_.a.Item,{variant:"dark",children:"Black to move."}),Object(a.jsx)(_.a.Item,{variant:"info",className:"myMovesList",children:e.moves})]})},V=(n(80),window.STOCKFISH);function z(e){var t=Object(r.useState)("start"),n=Object(j.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)([]),o=Object(j.a)(s,2),i=(o[0],o[1],Object(r.useState)("")),l=Object(j.a)(i,2),u=l[0],d=l[1],b=Object(r.useState)(""),h=Object(j.a)(b,2),m=h[0],O=h[1];Object(r.useEffect)((function(){W=R()(),c(W.fen()),p().prepareMove()}),[]),Object(r.useEffect)((function(){d(W.pgn()),O(W.turn())}));var p=function(e){e=e||{};var t,n="function"===typeof V?V():new Worker(e.stockfishjs||"stockfish.js"),a="function"===typeof V?V():new Worker(e.stockfishjs||"stockfish.js"),r={},s={wtime:3e3,btime:3e3,winc:1500,binc:1500},o=null;function i(e,t){(t||n).postMessage(e)}function l(){var e=("white"===s.clockColor?s.wtime:s.btime)+s.startTime-Date.now();o=setTimeout(l,e%1e3+1)}function j(){for(var e="",t=W.history({verbose:!0}),n=0;n<t.length;++n){var a=t[n];e+=" "+a.from+a.to+(a.promotion?a.promotion:"")}return e}setInterval((function(){t||W.game_over()&&(t=!0)}),500),i("uci");var u=function(){!function(){if(null!==o&&(clearTimeout(o),o=null),s.startTime>0){var e=Date.now()-s.startTime;s.startTime=null,"white"===s.clockColor?s.wtime=Math.max(0,s.wtime-e):s.btime=Math.max(0,s.btime-e)}}();var e="w"===W.turn()?"white":"black";W.game_over()||("black"!==e&&(i("position startpos moves"+j()),i("position startpos moves"+j(),a),i("eval",a),s&&s.wtime?i("go "+(s.depth?"depth "+s.depth:"")+" wtime "+s.wtime+" winc "+s.winc+" btime "+s.btime+" binc "+s.binc):i("go "+(s.depth?"depth "+s.depth:""))),W.history().length>=2&&!s.depth&&!s.nodes&&("w"===W.turn()?(s.wtime+=s.winc,s.clockColor="white"):(s.btime+=s.binc,s.clockColor="black"),s.startTime=Date.now(),l()))};return a.onmessage=function(e){var t;"uciok"!==(t=e&&"object"===typeof e?e.data:e)&&"readyok"!==t&&t.substr(0,11)},n.onmessage=function(e){var t;if("uciok"===(t=e&&"object"===typeof e?e.data:e))r.engineLoaded=!0;else if("readyok"===t)r.engineReady=!0;else{var n=t.match(/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/);if(n?(W.move({from:n[1],to:n[2],promotion:n[3]}),c(W.fen()),u(),i("eval",a)):(n=t.match(/^info .*\bdepth (\d+) .*\bnps (\d+)/))&&(r.search="Depth: "+n[1]+" Nps: "+n[2]),n=t.match(/^info .*\bscore (\w+) (-?\d+)/)){var s=parseInt(n[2],10)*("w"===W.turn()?1:-1);"cp"===n[1]?r.score=(s/100).toFixed(2):"mate"===n[1]&&(r.score="Mate in "+Math.abs(s)),(n=t.match(/\b(upper|lower)bound\b/))&&(r.score=("upper"===n[1]===("w"===W.turn())?"<= ":">= ")+r.score)}}},{start:function(){i("ucinewgame"),i("isready"),r.engineReady=!1,r.search=null,u(),t=!1},prepareMove:function(){u()}}};return e.children({position:a,handleDrop:function(e){var t=e.sourceSquare,n=e.targetSquare;if(null!==W.move({from:t,to:n,promotion:"q"}))return new Promise((function(e){c(W.fen()),e()})).then((function(){return p().prepareMove()}))},moves:u,turn:m})}var Z,K,Q,X,Y=function(e){return Object(a.jsx)("div",{className:"myGamespace",children:Object(a.jsx)(z,Object(l.a)(Object(l.a)({},e),{},{children:function(e){var t=e.position,n=e.handleDrop,r=e.moves,c=e.turn;return Object(a.jsxs)("div",{className:"myChessboard",children:[Object(a.jsx)(H.a,{id:"stockfish",position:t,width:550,onDrop:n,orientation:"black",boardStyle:{borderRadius:"5px",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.5)"}}),Object(a.jsx)(J,{moves:r,turn:c})]})}}))})},$="".concat(m);function ee(e){var t=Object(r.useState)("start"),n=Object(j.a)(t,2),c=n[0],s=n[1],o=Object(r.useState)({}),i=Object(j.a)(o,2),u=i[0],d=i[1],b=Object(r.useState)({}),h=Object(j.a)(b,2),m=h[0],O=h[1],p=Object(r.useState)(""),g=Object(j.a)(p,2),f=g[0],x=(g[1],Object(r.useState)([])),v=Object(j.a)(x,2),y=v[0],S=v[1],w=Object(r.useState)(""),k=Object(j.a)(w,2),N=k[0],U=k[1],q=Object(r.useState)("w"),M=Object(j.a)(q,2),L=M[0],_=M[1],D=Object(r.useState)(""),G=Object(j.a)(D,2),F=G[0],T=G[1],P=Object(r.useState)(""),A=Object(j.a)(P,2),H=A[0],W=A[1],J=Object(r.useState)(""),V=Object(j.a)(J,2),z=V[0],Y=V[1],ee=Object(r.useState)([]),ne=Object(j.a)(ee,2),ae=ne[0];ne[1];Object(r.useEffect)((function(){Q=R()(),K=E()($),Z=e.match.params.id,"w"===(X=e.match.params.color)&&0===H.length?(T("white"),W(e.loggedUser_id),K.emit("join_game",{roomId:Z,white:e.loggedUser._id})):"b"===X&&0===z.length?(T("black"),Y(e.loggedUser_id),K.emit("join_game",{roomId:Z,black:e.loggedUser._id})):ae.push(e.loggedUser._id)}),[]),Object(r.useEffect)((function(){K.on("receive_info",(function(e){s(e.position),U(e.moves),_(e.turn),Q.load_pgn(e.moves)}))}));return e.loggedUser?e.children({position:c,handleMouseOverSquare:function(e){var t=Q.moves({square:e,verbose:!0});if(0!==t.length){for(var n=[],a=0;a<t.length;a++)n.push(t[a].to);!function(e,t){var n=[e].concat(Object(I.a)(t)).reduce((function(e,t){return Object(l.a)(Object(l.a)(Object(l.a)({},e),Object(C.a)({},t,{background:"radial-gradient(circle, #fffc00 36%, transparent 40%)",borderRadius:"50%"})),te({history:y,pieceSquare:f}))}),{});O(Object(l.a)(Object(l.a)({},m),n))}(e,n)}},handleMouseOutSquare:function(e){O(te({pieceSquare:f,history:y}))},handleDrop:function(e){var t=e.sourceSquare,n=e.targetSquare;X===Q.turn()&&(null!==Q.move({from:t,to:n,promotion:"q"})&&(s(Q.fen()),S(Q.history({verbose:!0})),U(Q.pgn()),_(Q.turn()),O(te({pieceSquare:f,history:y})),K.emit("send_game_info",{room:Z,moves:Q.pgn(),position:Q.fen(),turn:Q.turn()})))},handleSquareRightClick:function(e){return O(Object(C.a)({},e,{backgroundColor:"deepPink"}))},handleDragOverSquare:function(e){d("e4"===e||"d4"===e||"e5"===e||"d5"===e?{backgroundColor:"cornFlowerBlue"}:{boxShadow:"inset 0 0 1px 4px rgb(255, 255, 0)"})},dropSquareStyle:u,squareStyles:m,moves:N,turn:L,orientation:F}):Object(a.jsx)(B.a,{animation:"border",role:"status",variant:"light",children:Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})})}var te=function(e){var t=e.pieceSquare,n=e.history,a=n.length&&n[n.length-1].from,r=n.length&&n[n.length-1].to;return Object(l.a)(Object(l.a)(Object(C.a)({},t,{backgroundColor:"rgba(255, 255, 0, 0.4)"}),n.length&&Object(C.a)({},a,{backgroundColor:"rgba(255, 255, 0, 0.4)"})),n.length&&Object(C.a)({},r,{backgroundColor:"rgba(255, 255, 0, 0.4)"}))},ne=function(e){return Object(a.jsx)(ee,Object(l.a)(Object(l.a)({},e),{},{children:function(e){var t=e.position,n=e.handleDrop,r=e.handleMouseOverSquare,c=e.handleMouseOutSquare,s=e.handleDragOverSquare,o=e.handleSquareRightClick,i=e.squareStyles,l=e.dropSquareStyle,j=e.moves,u=e.turn,d=e.orientation;return Object(a.jsxs)("div",{className:"myChessboard",children:[Object(a.jsx)(H.a,{id:"HumanVsHuman",width:550,orientation:d,position:t,onDrop:n,onMouseOverSquare:r,onMouseOutSquare:c,onSquareRightClick:o,onDragOverSquare:s,squareStyles:i,dropSquareStyle:l,boardStyle:{borderRadius:"5px",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.5)"}}),Object(a.jsx)("div",{className:"movesAndButton",children:Object(a.jsx)(J,{moves:j,turn:u})})]})}}))};n(149);var ae=function(e){return e.loggedUser?"/stockfish"===e.match.path?Object(a.jsx)("div",{children:Object(a.jsx)(Y,{})}):Object(a.jsxs)("div",{className:"myGame",children:[Object(a.jsx)(T,Object(l.a)({loggedUser:e.loggedUser},e)),Object(a.jsx)(ne,Object(l.a)({loggedUser:e.loggedUser},e))]}):Object(a.jsx)(B.a,{animation:"border",role:"status",variant:"light",children:Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})})};n(150);var re=function(e){var t=Object(r.useState)([]),n=Object(j.a)(t,2),c=n[0],s=n[1];return Object(r.useEffect)((function(){d.a.get("".concat(h,"/games"),{withCredentials:!0}).then((function(e){s(e.data),console.log(e.data)}))}),[]),c.length?Object(a.jsxs)("div",{className:"myProfile",children:[Object(a.jsxs)(L.a,{style:{width:"400px"},children:[Object(a.jsx)(L.a.Img,{variant:"top",src:e.loggedUser.image}),Object(a.jsxs)(L.a.Body,{children:[Object(a.jsx)(L.a.Title,{children:e.loggedUser.username}),Object(a.jsx)(L.a.Text,{children:e.loggedUser.about}),Object(a.jsx)(i.b,{to:"/edit",children:Object(a.jsx)(f.a,{variant:"primary",children:"Edit"})})]})]}),Object(a.jsx)("div",{className:"myGamesList",children:c.map((function(e){return Object(a.jsx)("div",{className:"myGameInfoContainer",children:Object(a.jsx)(_.a,{children:Object(a.jsx)(_.a.Item,{children:Object(a.jsxs)("div",{className:"myGameInfo",children:[Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"Id:"})," ",e.roomId]}),Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"White:"})," ",e.white]}),Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"Black:"})," ",e.black?e.black:"N/A"]}),Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"Moves:"})," ",e.movetext]})]})})})})}))})]}):Object(a.jsx)(B.a,{animation:"border",role:"status",variant:"light",children:Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})})};var ce=function(e){return e.loggedUser?Object(a.jsx)("div",{className:"myFormContainer",children:Object(a.jsxs)(v.a,{onSubmit:e.onSubmit,children:[Object(a.jsx)(v.a.Group,{children:Object(a.jsx)(v.a.File,{name:"image",id:"formBasicFile",label:"Example file input"})}),Object(a.jsxs)(v.a.Group,{controlId:"formBasicAbout",children:[Object(a.jsx)(v.a.Label,{children:"About"}),Object(a.jsx)(v.a.Control,{name:"about",type:"text",placeholder:"Enter something about yourself"})]}),Object(a.jsx)(f.a,{variant:"primary",type:"submit",children:"Submit"})]})}):Object(a.jsx)(B.a,{animation:"border",role:"status",variant:"light",children:Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})})};n(151);var se=Object(b.f)((function(e){var t=Object(r.useState)(null),n=Object(j.a)(t,2),c=n[0],s=n[1],o=Object(r.useState)(null),i=Object(j.a)(o,2),u=i[0],m=i[1];Object(r.useEffect)((function(){c||d.a.get("".concat(h,"/user"),{withCredentials:!0}).then((function(e){s(e.data)}))}),[]);var O=function(t){t.preventDefault();var n=t.target,a=n.username,r=n.email,c=n.password;d.a.post("".concat(h,"/signup"),{username:a.value,email:r.value,password:c.value},{withCredentials:!0}).then((function(t){s(t.data),e.history.push("/")})).catch((function(e){m(e.response.data.error)}))},g=function(t){t.preventDefault();var n=t.target,a=n.email,r=n.password;d.a.post("".concat(h,"/signin"),{email:a.value,password:r.value},{withCredentials:!0}).then((function(t){s(t.data),e.history.push("/")})).catch((function(e){m(e.response.data.error)}))},f=function(t){t.preventDefault();var n=t.target,a=n.about,r=n.image.files[0],o=new FormData;o.append("imageUrl",r),d.a.post("".concat(h,"/upload"),o).then((function(t){var n={about:a.value,image:t.data.image};d.a.patch("".concat(h,"/edit"),n,{withCredentials:!0}).then((function(t){console.log("This is edit response!",t.data),s(t.data),e.history.push("/private/".concat(c._id))}))}))},v=function(){m(null)};return Object(a.jsxs)("div",{className:"myApp",children:[Object(a.jsx)("header",{children:Object(a.jsx)(p,{loggedUser:c,onLogout:function(t){d.a.post("".concat(h,"/logout"),{},{withCredentials:!0}).then((function(){s(null),e.history.push("/")}))}})}),Object(a.jsx)("main",{children:Object(a.jsxs)(b.c,{children:[Object(a.jsx)(b.a,{exact:!0,path:"/",render:function(){return Object(a.jsx)(x,{loggedUser:c})}}),Object(a.jsx)(b.a,{path:"/signin",render:function(e){return Object(a.jsx)(y,Object(l.a)({onUnmount:v,errorMsg:u,onSignin:g},e))}}),Object(a.jsx)(b.a,{path:"/signup",render:function(e){return Object(a.jsx)(k,Object(l.a)({onUnmount:v,errorMsg:u,onSignup:O},e))}}),Object(a.jsx)(b.a,{path:"/private/:id",render:function(){return Object(a.jsx)(re,{loggedUser:c})}}),Object(a.jsx)(b.a,{path:"/edit",render:function(){return Object(a.jsx)(ce,{loggedUser:c,onSubmit:f})}}),Object(a.jsx)(b.a,{path:"/public/:id",render:function(){return Object(a.jsx)(PublicProfile,{loggedUser:c})}}),Object(a.jsx)(b.a,{path:"/stockfish",render:function(e){return Object(a.jsx)(ae,Object(l.a)({loggedUser:c},e))}}),Object(a.jsx)(b.a,{exact:!0,path:"/game/:id/:color",render:function(e){return Object(a.jsx)(ae,Object(l.a)({loggedUser:c},e))}})]})})]})}));n(152),n(153);o.a.render(Object(a.jsx)(i.a,{children:Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(se,{})})}),document.getElementById("root"))},67:function(e,t,n){},80:function(e,t,n){}},[[154,1,2]]]);
//# sourceMappingURL=main.ab141e56.chunk.js.map